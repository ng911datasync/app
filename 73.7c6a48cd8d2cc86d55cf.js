(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/graphics/sources/support/CSVSourceWorker":1033,"esri/core/number":1217,"dstore/Csv":1713})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[73],{1033:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(8),i(9),i(1713),i(18),i(31),i(10),i(15),i(7),i(1217),i(4),i(23),i(1100),i(37),i(35),i(205),i(196),i(1123),i(1070),i(1094),i(1274),i(328)],void 0===(r=function(e,t,i,n,r,a,l,o,s,u,d,f,c,p,g,h,m,v,y,x,F,N,b){Object.defineProperty(t,"__esModule",{value:!0});var I=N.createDrawingInfo("esriGeometryPoint"),w=["esriFieldTypeSmallInteger","esriFieldTypeInteger","esriFieldTypeSingle","esriFieldTypeDouble","esriFieldTypeLong"];t.csvLatitudeFieldNames=["lat","latitude","y","ycenter","latitude83","latdecdeg","point-y"],t.csvLongitudeFieldNames=["lon","lng","long","longitude","x","xcenter","longitude83","longdecdeg","point-x"],t.csvDetectedDelimiters=[","," ",";","|","\t"];var _,E,T,D,O=/^((jan(uary)?)|(feb(ruary)?)|(mar(ch)?)|(apr(il)?)|(may)|(jun(e)?)|(jul(y)?)|(aug(ust)?)|(sep(tember)?)|(oct(ober)?)|(nov(ember)?)|(dec(ember)?)|(am)|(pm)|(gmt)|(utc))$/i,S=[0,0],j=function(e,t){this.x=e,this.y=t},k=(_=d._parseInfo(),E=new RegExp("^"+_.regexp+"$"),T=new RegExp("["+_.group+"\\s\\xa0]","g"),D=_.factor,function(e){var t=E.exec(e);if(_.factor=D,!t)return NaN;var i=t[1];if(!t[1]){if(!t[2])return NaN;i=t[2],_.factor*=-1}return+(i=i.replace(T,"").replace(_.decimal,"."))*_.factor}),q="isInteger"in Number?Number.isInteger:function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},C=function(){function e(){this._fieldsIndex=null,this._queryEngine=null}return e.prototype.destroy=function(){this._queryEngine&&this._queryEngine&&this._queryEngine.destroy(),this._queryEngine=null,this._fieldsIndex=null},e.prototype.load=function(e,t){return void 0===t&&(t={}),n(this,void 0,void 0,(function(){var n,r,a,l,o;return i(this,(function(i){switch(i.label){case 0:return[4,f.all([this._fetch(e.url,t),this._checkProjection(t&&e.parsing&&e.parsing.spatialReference)])];case 1:return n=i.sent()[0],r=this._parse(n,e.parsing),this._queryEngine=this._createQueryEngine(n,r),r.layerDefinition.extent=this._queryEngine.fullExtent,r.layerDefinition.timeInfo&&(a=this._queryEngine.timeExtent,l=a.start,o=a.end,r.layerDefinition.timeInfo.timeExtent=[l,o]),[2,r]}}))}))},e.prototype.applyEdits=function(){return n(this,void 0,void 0,(function(){return i(this,(function(e){throw new o("csv-source:editing-not-supported","applyEdits() is not supported on CSVLayer")}))}))},e.prototype.queryFeatures=function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),n(this,void 0,void 0,(function(){return i(this,(function(i){return[2,this._queryEngine.executeQuery(e,t.signal)]}))}))},e.prototype.queryFeatureCount=function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),n(this,void 0,void 0,(function(){return i(this,(function(i){return[2,this._queryEngine.executeQueryForCount(e,t.signal)]}))}))},e.prototype.queryObjectIds=function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),n(this,void 0,void 0,(function(){return i(this,(function(i){return[2,this._queryEngine.executeQueryForIds(e,t.signal)]}))}))},e.prototype.queryExtent=function(e,t){return void 0===e&&(e={}),void 0===t&&(t={}),n(this,void 0,void 0,(function(){return i(this,(function(i){return[2,this._queryEngine.executeQueryForExtent(e,t.signal)]}))}))},e.prototype._fetch=function(e,t){return n(this,void 0,void 0,(function(){var n;return i(this,(function(i){switch(i.label){case 0:if(!e)throw new o("csv-source:invalid-source","url not defined");return n=c.urlToObject(e),[4,l(n.path,{query:n.query,responseType:"text",signal:t.signal})];case 1:return[2,i.sent().data]}}))}))},e.prototype._parse=function(e,t){void 0===t&&(t={});for(var i={columnDelimiter:t.columnDelimiter,layerDefinition:null,locationInfo:{latitudeFieldName:t.latitudeField,longitudeFieldName:t.longitudeField}};e&&"\n"===e[0];)e=e.slice(1);"\n"!==e[e.length-1]&&(e+="\n");var n=this._readFirstLine(e);if(!n)throw new o("csv","CSV is empty",{csv:e});if(!t.columnDelimiter){var r=this._inferDelimiter(n);if(!r)throw new o("csv-source:invalid-delimiter","Unable to detect the delimiter from CSV");i.columnDelimiter=r}var a=n.split(i.columnDelimiter),l=i.layerDefinition={name:"csv",drawingInfo:I,geometryType:"esriGeometryPoint",objectIdField:null,fields:[],timeInfo:t.timeInfo,extent:{xmin:Number.POSITIVE_INFINITY,ymin:Number.POSITIVE_INFINITY,xmax:Number.NEGATIVE_INFINITY,ymax:Number.NEGATIVE_INFINITY,spatialReference:t.spatialReference||{wkid:102100}}};if(!t.latitudeField||!t.longitudeField){var s=this._inferLocationInfo(a);if(!t.longitudeField&&!s.longitudeFieldName||!t.latitudeField&&!s.latitudeFieldName)throw new o("csv","Unable to identify latitudeField and/or longitudeField from CSV");i.locationInfo={longitudeFieldName:t.longitudeField||s.longitudeFieldName,latitudeFieldName:t.latitudeField||s.latitudeFieldName}}var d=this._inferFields(e,i.columnDelimiter,a,i.locationInfo);if(t.fields&&t.fields.length){for(var f=new Map,c=0,p=t.fields;c<p.length;c++){var g=p[c];f.set(g.name.toLowerCase(),g)}for(var h=0,m=d;h<m.length;h++){g=m[h];var v=f.get(g.name.toLowerCase());if(v){var y=g.name;u.mixin(g,v),g.name=y}}}if(l.fields=d,l.fields.some((function(e){return"esriFieldTypeOID"===e.type&&(l.objectIdField=e.name,!0)}))||(g={name:"__OBJECTID",alias:"__OBJECTID",type:"esriFieldTypeOID",editable:!1,nullable:!1},l.objectIdField=g.name,l.fields.unshift(g)),this._fieldsIndex=new b(l.fields),l.timeInfo){var x=l.timeInfo;if(x.startTimeField){var F=this._fieldsIndex.get(x.startTimeField);F?(x.startTimeField=F.name,F.type="esriFieldTypeDate"):x.startTimeField=null}if(x.endTimeField){var N=this._fieldsIndex.get(x.endTimeField);N?(x.endTimeField=N.name,N.type="esriFieldTypeDate"):x.endTimeField=null}if(x.trackIdField){var w=this._fieldsIndex.get(x.trackIdField);x.trackIdField=w?w.name:null}x.startTimeField||x.endTimeField||(l.timeInfo=null)}return i},e.prototype._inferLocationInfo=function(e){var i=null,n=null;return e.forEach((function(e){var r=e.toLowerCase();-1===t.csvLatitudeFieldNames.indexOf(r)||n||(n=e),-1===t.csvLongitudeFieldNames.indexOf(r)||i||(i=e)})),{longitudeFieldName:i,latitudeFieldName:n}},e.prototype._inferFields=function(e,t,i,n){for(var r=[],a=this._sampleLines(e).map((function(e){return e.split(t).map((function(e){return e.trim()}))})),l=function(e){var t=i[e];if(t===n.longitudeFieldName||t===n.latitudeFieldName)r.push({name:t,type:"esriFieldTypeDouble",alias:t});else{var l=a.map((function(t){return t[e]})),s={name:t,type:null,alias:t};switch(o._inferFieldType(l)){case"integer":s.type="esriFieldTypeInteger";break;case"double":s.type="esriFieldTypeDouble";break;case"date":s.type="esriFieldTypeDate",s.length=36;break;default:s.type="esriFieldTypeString",s.length=255}r.push(s)}},o=this,s=0;s<i.length;s++)l(s);return r},e.prototype._inferFieldType=function(e){var t=this;if(!e.length)return"string";var i=/[^+-.,0-9]/;return e.map((function(e){var n=!1;if(""===e||i.test(e))n=!0;else{var r=k(e);if(!isNaN(r))return/[.,]/.test(e)||!q(r)||r>214783647||r<-214783648?"double":"integer";if(-1===e.indexOf("E"))n=!0;else{if(r=Number(e),!isNaN(r))return"double";if(-1===e.indexOf(","))n=!0;else{if(e=e.replace(",","."),r=Number(e),!isNaN(r))return"double";n=!0}}}if(n){if(!/^[-]?\d*[.,]?\d*$/.test(e)){var a=new Date(e);return t._isValidDate(a,e)?"date":"string"}return"string"}return"string"})).reduce((function(e,t){return e===t?t:"string"===e||"string"===t?"string":"double"===e||"double"===t?"double":void 0}))},e.prototype._isValidDate=function(e,t){if(!e||"[object Date]"!==Object.prototype.toString.call(e)||isNaN(e.getTime()))return!1;var i=!0;if(s("chrome")&&/\d+\W*$/.test(t)){var n=t.match(/[a-zA-Z]{2,}/);if(n){for(var r=!1,a=0;!r&&a<=n.length;)r=!O.test(n[a]),a++;i=!r}}return i},e.prototype._readFirstLine=function(e){return e.substring(0,e.indexOf("\n")).trim()},e.prototype._sampleLines=function(e,t){void 0===t&&(t=10);for(var i=!1,n=[],r=e.indexOf("\n")+1;!i&&n.length<t;){var a=e.indexOf("\n",r);if(-1!==a){var l;(l=-1===a&&r<e.length-1?e.substring(r).trim():e.substring(r,a).trim())&&n.push(l),r=a+1}else i=!0}return n},e.prototype._inferDelimiter=function(e){var i=0,n="";return t.csvDetectedDelimiters.forEach((function(t){var r=e.split(t).length;r>i&&(i=r,n=t)})),""===n?null:n},e.prototype._createQueryEngine=function(e,t){for(var i,n=t.locationInfo,l=n.latitudeFieldName,o=n.longitudeFieldName,s=t.layerDefinition,u=s.objectIdField,d=s.fields,f=s.extent,c=s.timeInfo,x=[],N=[],b=new Set,I=new Set,_=[],E=0,T=d;E<T.length;E++){var D=T[E],O=D.name,q=D.type;"esriFieldTypeDate"===q?b.add(O):w.indexOf(q)>-1&&I.add(O),O!==u&&_.push(O)}var C=new r;C.delimiter=t.columnDelimiter,C.fieldNames=_,C.newline="\n";var L=C.parse(e),R=0;L.shift();for(var V=0,M=L;V<M.length;V++){var P=M[V],z=this._parseCoordinateValue(P[l]),G=this._parseCoordinateValue(P[o]);if(null!=G&&null!=z&&!isNaN(z)&&!isNaN(G)){for(var Q in P[l]=z,P[o]=G,P)if(Q!==l&&Q!==o)if(b.has(Q)){var $=new Date(P[Q]);P[Q]=this._isValidDate($,P[Q])?$.getTime():null}else if(I.has(Q)){var A=k(P[Q]);isNaN(A)?P[Q]=null:P[Q]=A}P[u]=R,R++,x.push(new j(G,z)),N.push(P)}}if(!g.equals({wkid:4326},f.spatialReference))if(g.isWebMercator(f.spatialReference))for(var J=0,W=x;J<W.length;J++){var Y=W[J];i=h.lngLatToXY(Y.x,Y.y,S),Y.x=i[0],Y.y=i[1]}else x=p.projectMany(x,a.SpatialReference.WGS84,f.spatialReference,null,!0);for(var Z=new y.default({geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1}),B=new F.default({fields:t.layerDefinition.fields,geometryType:"esriGeometryPoint",hasM:!1,hasZ:!1,timeInfo:c,objectIdField:u,spatialReference:f.spatialReference||{wkid:4326},cacheSpatialQueries:!0,featureStore:Z}),U=[],X=0;X<x.length;X++){var H=x[X],K=H.x,ee=H.y,te=N[X];te[u]=X+1,U.push(new m.default(new v.default([],[K,ee]),te,null,te[u]))}return Z.addMany(U),B},e.prototype._parseCoordinateValue=function(e){if(null==e||""===e)return null;var t=k(e);return(isNaN(t)||Math.abs(t)>181)&&(t=parseFloat(e)),t},e.prototype._checkProjection=function(e){return n(this,void 0,void 0,(function(){return i(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),[4,x.checkProjectionSupport(g.WGS84,e)];case 1:return t.sent(),[3,3];case 2:throw t.sent(),new o("csv-layer","Projection not supported");case 3:return[2]}}))}))},e}();t.default=C}.apply(null,n))||(e.exports=r)},1217:function(e,t,i){var n,r;n=[i.dj.c(e.i),t,i(5),i(46),i(217)],void 0===(r=function(e,t,i,n,r){Object.defineProperty(t,"__esModule",{value:!0});var a={ar:[".",","],bs:[",","."],ca:[",","."],cs:[","," "],da:[",","."],de:[",","."],"de-ch":[".","’"],el:[",","."],en:[".",","],"en-au":[".",","],es:[",","."],"es-mx":[".",","],et:[","," "],fi:[","," "],fr:[","," "],"fr-ch":[","," "],he:[".",","],hi:[".",",","#,##,##0.###"],hr:[",","."],hu:[","," "],id:[",","."],it:[",","."],"it-ch":[".","’"],ja:[".",","],ko:[".",","],lt:[","," "],lv:[","," "],mk:[",","."],nb:[","," "],nl:[",","."],pl:[","," "],pt:[",","."],"pt-pt":[","," "],ro:[",","."],ru:[","," "],sk:[","," "],sl:[",","."],sr:[",","."],sv:[","," "],th:[".",","],tr:[",","."],uk:[","," "],vi:[",","."],zh:[".",","]};function l(e){e||(e=r.getLocale());var t=e in a;if(!t){var i=e.split("-");i.length>1&&i[0]in a&&(e=i[0],t=!0),t||(e="en")}var n=a[e],l=n[0],o=n[1],s=n[2];return{decimal:l,group:o,pattern:void 0===s?"#,##0.###":s}}t.getCustoms=l,t.format=function(e,t){var r=l((t=i({},t)).locale);t.customs=r;var a=t.pattern||r.pattern;return isNaN(e)||Math.abs(e)===1/0?null:function(e,t,i){var r=(i=i||{}).customs.group,a=i.customs.decimal,l=t.split(";"),s=l[0];if(-1!==(t=l[e<0?1:0]||"-"+s).indexOf("%"))e*=100;else if(-1!==t.indexOf("‰"))e*=1e3;else{if(-1!==t.indexOf("¤"))throw new Error("currency notation not supported");if(-1!==t.indexOf("E"))throw new Error("exponential notation not supported")}var u=o,d=s.match(u);if(!d)throw new Error("unable to find a number expression in pattern: "+t);return!1===i.fractional&&(i.places=0),t.replace(u,function(e,t,i){!0===(i=i||{}).places&&(i.places=0),i.places===1/0&&(i.places=6);var r=t.split("."),a="string"==typeof i.places&&i.places.indexOf(","),l=i.places;a?l=i.places.substring(a+1):l>=0||(l=(r[1]||[]).length),i.round<0||(e=Number(e.toFixed(Number(l))));var o=String(Math.abs(e)).split("."),s=o[1]||"";if(r[1]||i.places){a&&(i.places=i.places.substring(0,a));var u=void 0!==i.places?i.places:r[1]&&r[1].lastIndexOf("0")+1;u>s.length&&(o[1]=n.padEnd(s,Number(u),"0")),l<s.length&&(o[1]=s.substr(0,Number(l)))}else o[1]&&o.pop();var d=r[0].replace(",",""),f=d.indexOf("0");-1!==f&&((f=d.length-f)>o[0].length&&(o[0]=n.padStart(o[0],f,"0")),-1===d.indexOf("#")&&(o[0]=o[0].substr(o[0].length-f)));var c,p,g=r[0].lastIndexOf(",");if(-1!==g){c=r[0].length-g-1;var h=r[0].substr(0,g);-1!==(g=h.lastIndexOf(","))&&(p=h.length-g-1)}for(var m=[],v=o[0];v;){var y=v.length-c;m.push(y>0?v.substr(y):v),v=y>0?v.slice(0,y):"",p&&(c=p,p=void 0)}return o[0]=m.reverse().join(i.group||","),o.join(i.decimal||".")}(e,d[0],{decimal:a,group:r,places:i.places,round:i.round}))}(e,a,t)};var o=/[#0,]*[#0](?:\.0*#*)?/;function s(e){var t=l((e=e||{}).locale),i=e.pattern||t.pattern,r=t.group,a=t.decimal,s=1;if(-1!==i.indexOf("%"))s/=100;else if(-1!==i.indexOf("‰"))s/=1e3;else if(-1!==i.indexOf("¤"))throw new Error("currency notation not supported");var f=i.split(";");return 1===f.length&&f.push("-"+f[0]),{regexp:d(f,(function(t){return(t="(?:"+n.escapeRegExpString(t,".")+")").replace(o,(function(t){var i={signed:!1,separator:e.strict?r:[r,""],fractional:e.fractional,decimal:a,exponent:!1},n=t.split("."),l=e.places;1===n.length&&1!==s&&(n[1]="###"),1===n.length||0===l?i.fractional=!1:(void 0===l&&(l=e.pattern?n[1].lastIndexOf("0")+1:1/0),l&&null==e.fractional&&(i.fractional=!0),!e.places&&l<n[1].length&&(l+=","+n[1].length),i.places=l);var o=n[0].split(",");return o.length>1&&(i.groupSize=o.pop().length,o.length>1&&(i.groupSize2=o.pop().length)),"("+function(e){"places"in(e=e||{})||(e.places=1/0),"string"!=typeof e.decimal&&(e.decimal="."),"fractional"in e&&!/^0/.test(String(e.places))||(e.fractional=[!0,!1]),"exponent"in e||(e.exponent=[!0,!1]),"eSigned"in e||(e.eSigned=[!0,!1]);var t=u(e),i=d(e.fractional,(function(t){var i="";return t&&0!==e.places&&(i="\\"+e.decimal,e.places===1/0?i="(?:"+i+"\\d+)?":i+="\\d{"+e.places+"}"),i}),!0),n=t+i;return i&&(n="(?:(?:"+n+")|(?:"+i+"))"),n+d(e.exponent,(function(t){return t?"([eE]"+u({signed:e.eSigned})+")":""}))}(i)+")"}))}),!0).replace(/[\xa0 ]/g,"[\\s\\xa0]"),group:r,decimal:a,factor:s}}function u(e){return"signed"in(e=e||{})||(e.signed=[!0,!1]),"separator"in e?"groupSize"in e||(e.groupSize=3):e.separator="",d(e.signed,(function(e){return e?"[-+]":""}),!0)+d(e.separator,(function(t){if(!t)return"(?:\\d+)";" "===(t=n.escapeRegExpString(t))?t="\\s":" "===t&&(t="\\s\\xa0");var i=e.groupSize,r=e.groupSize2;if(r){var a="(?:0|[1-9]\\d{0,"+(r-1)+"}(?:["+t+"]\\d{"+r+"})*["+t+"]\\d{"+i+"})";return i-r>0?"(?:"+a+"|(?:0|[1-9]\\d{0,"+(i-1)+"}))":a}return"(?:0|[1-9]\\d{0,"+(i-1)+"}(?:["+t+"]\\d{"+i+"})*)"}),!0)}t.regexp=function(e){return s(e).regexp},t._parseInfo=s,t.parse=function(e,t){var i=s(t),n=new RegExp("^"+i.regexp+"$").exec(e);if(!n)return NaN;var r=n[1];if(!n[1]){if(!n[2])return NaN;r=n[2],i.factor*=-1}return r=r.replace(new RegExp("["+i.group+"\\s\\xa0]","g"),"").replace(i.decimal,"."),Number(r)*i.factor};var d=function(e,t,i){if(!(e instanceof Array))return t(e);for(var n=[],r=0;r<e.length;r++)n.push(t(e[r]));return f(n.join("|"),i)},f=function(e,t){return"("+(t?"?:":"")+e+")"}}.apply(null,n))||(e.exports=r)},1713:function(e,t,i){var n,r;n=[i(32),i(352)],void 0===(r=function(e,t){var i=/^\s*"([\S\s]*)"\s*$/,n=/""/g,r=/"/g;function a(e,t){var i,n={},r=e.length;for(i=0;i<r;i++)n[e[i]]=t[i];return n}return t(null,{fieldNames:null,delimiter:",",newline:"\r\n",trim:!1,parse:function(t){var r,l,o,s,u,d,f,c,p=[],g=t.split(this.newline),h=this.fieldNames,m=0,v=[],y="",x="";e:for(d=0,o=g.length;d<o;d++)if(e.trim(g[d])){for(f=0,s=(r=g[d].split(this.delimiter)).length;f<s;f++){for(c=-1,y+=x+(l=r[f]),x="";(c=l.indexOf('"',c+1))>=0;)m++;if(m%2==0){if(m>0){if(!(u=i.exec(y))){v=[],y="",m=0;continue e}v.push(u[1].replace(n,'"'))}else v.push(this.trim||!h?e.trim(y):y);y="",m=0}else x=this.delimiter}0===m?(h?p.push(a(h,v)):h=this.fieldNames=v,v=[]):x=this.newline}return p},toCsv:function(e){return this.stringify(this.data,e)},stringify:function(e,t){var i,n,a,l=(t=t||{}).alwaysQuote,o=this.fieldNames,s=this.delimiter,u=this.newline,d="";for(i=-1;i<e.length;i++)for(i>-1&&(d+=u),n=0;n<o.length;n++)null==(a=i<0?o[n]:e[i][o[n]])&&(a=""),"string"!=typeof a&&(a=a.toString()),d+=(n>0?s:"")+(l||a.indexOf('"')>=0||a.indexOf(s)>=0?'"'+a.replace(r,'""')+'"':a);return t.trailingNewline&&(d+=u),d}})}.apply(null,n))||(e.exports=r)}}]);