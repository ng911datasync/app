(function(){(this||window).webpackJsonp.registerAbsMids({"esri/tasks/ClosestFacilityTask":1024,"esri/tasks/support/GPMessage":1128,"esri/core/queryUtils":1168,"esri/tasks/mixins/NAServiceDescription":1169,"esri/tasks/support/NAMessage":1170,"esri/tasks/support/DirectionsFeatureSet":1252,"esri/tasks/support/ClosestFacilitySolveResult":1525})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[67],{1024:function(e,r,t){var o,n;o=[t.dj.c(e.i),r,t(5),t(1),t(0),t(31),t(4),t(1168),t(2),t(329),t(107),t(1169),t(1525)],void 0===(n=function(e,r,t,o,n,i,s,a,p,u,l,c,f){var d=a.createQueryParamsHelper({accumulateAttributes:{name:"accumulateAttributeNames"},attributeParameterValues:!0,directionsTimeAttribute:{name:"directionsTimeAttributeName"},impedanceAttribute:{name:"impedanceAttributeName"},facilities:!0,incidents:!0,outSpatialReference:{name:"outSR",getter:function(e){return e.outSpatialReference.wkid}},pointBarriers:{name:"barriers"},polylineBarriers:!0,polygonBarriers:!0,restrictionAttributes:{name:"restrictionAttributeNames"},returnPointBarriers:{name:"returnBarriers"},returnRoutes:{name:"returnCFRoutes"},travelMode:!0});return function(e){function r(r){var t=e.call(this,r)||this;return t.url=null,t}return o(r,e),r.prototype.solve=function(e,r){var o=this,n=[],a=[],p={},l={};return e.incidents&&e.incidents.features&&this._collectGeometries(e.incidents.features,a,"incidents.features",p),e.facilities&&e.facilities.features&&this._collectGeometries(e.facilities.features,a,"facilities.features",p),e.pointBarriers&&e.pointBarriers.features&&this._collectGeometries(e.pointBarriers.features,a,"pointBarriers.features",p),e.polylineBarriers&&e.polylineBarriers.features&&this._collectGeometries(e.polylineBarriers.features,a,"polylineBarriers.features",p),e.polygonBarriers&&e.polygonBarriers.features&&this._collectGeometries(e.polygonBarriers.features,a,"polygonBarriers.features",p),u.normalizeCentralMeridian(a).then((function(e){for(var r in p){var t=p[r];n.push(r),l[r]=e.slice(t[0],t[1])}return o._isInputGeometryZAware(l,n)?o.getServiceDescription():s.resolve({dontCheck:!0})})).then((function(s){("dontCheck"in s?s.dontCheck:s.hasZ)||o._dropZValuesOffInputGeometry(l,n);var a=function(r){l[r].forEach((function(t,o){e.get(r)[o].geometry=t}))};for(var p in l)a(p);var u={query:t({},o.parsedUrl.query,{f:"json"},d.toQueryParams(e))};return(o.requestOptions||r)&&(u=t({},o.requestOptions,r,u)),i(o.parsedUrl.path+"/solveClosestFacility",u)})).then((function(e){return f.fromJSON(e.data)}))},r.prototype._collectGeometries=function(e,r,t,o){o[t]=[r.length,r.length+e.length],e.forEach((function(e){r.push(e.geometry)}))},n([p.property()],r.prototype,"url",void 0),n([p.subclass("esri.tasks.ClosestFacilityTask")],r)}(p.declared(c.NAServiceDescriptionMixin(l)))}.apply(null,o))||(e.exports=n)},1128:function(e,r,t){var o,n;o=[t.dj.c(e.i),r,t(1),t(0),t(12),t(3),t(2)],void 0===(n=function(e,r,t,o,n,i,s){var a=new n.default({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});return function(e){function r(r){var t=e.call(this,r)||this;return t.description=null,t.type=null,t}return t(r,e),o([s.property({type:String,json:{write:!0}})],r.prototype,"description",void 0),o([s.property({type:String,json:{read:a.read,write:a.write}})],r.prototype,"type",void 0),o([s.subclass("esri.tasks.support.GPMessage")],r)}(s.declared(i.JSONSupport))}.apply(null,o))||(e.exports=n)},1168:function(e,r,t){var o,n;o=[t.dj.c(e.i),r],void 0===(n=function(e,r){Object.defineProperty(r,"__esModule",{value:!0});var t=function(){function e(e){void 0===e&&(e={}),this._options=e}return e.prototype.toQueryParams=function(e){var r=this;if(!e)return null;var t=e.toJSON(),o={};return Object.keys(t).forEach((function(e){var n=r._options[e];if(n){var i="boolean"!=typeof n&&n.name?n.name:e,s="boolean"!=typeof n&&n.getter?n.getter(t):t[e];null!=s&&(o[i]=function(e){if(!Array.isArray(e))return!1;var r=e[0];return"number"==typeof r||"string"==typeof r}(s)?s.join(","):"object"==typeof s?JSON.stringify(s):s)}else o[e]=t[e]}),this),o},e}();r.createQueryParamsHelper=function(e){return new t(e)}}.apply(null,o))||(e.exports=n)},1169:function(e,r,t){var o,n;o=[t.dj.c(e.i),r,t(0),t(1),t(8),t(9),t(31),t(10),t(13),t(40),t(23),t(2),t(107)],void 0===(n=function(e,r,t,o,n,i,s,a,p,u,l,c,f){Object.defineProperty(r,"__esModule",{value:!0}),r.NAServiceDescriptionMixin=function(e){return function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o(r,e),r.prototype.getServiceDescription=function(){return i(this,void 0,void 0,(function(){return n(this,(function(e){return this._serviceDescriptionPromise||(this._serviceDescriptionPromise=this._fetchServiceDescription()),[2,this._serviceDescriptionPromise]}))}))},r.prototype._fetchServiceDescription=function(){return i(this,void 0,void 0,(function(){var e,r,t,o,p,c;return n(this,(function(f){switch(f.label){case 0:if(!this.url||!this.parsedUrl)throw new a("network-service:missing-url","Url to Network service is missing");return e=this.url,[4,s(e,{query:{f:"json"}})];case 1:for((r=f.sent().data).supportedTravelModes||(r.supportedTravelModes=[]),t=0;t<r.supportedTravelModes.length;t++)r.supportedTravelModes[t].id||(r.supportedTravelModes[t].id=r.supportedTravelModes[t].itemId);return[4,r.currentVersion>=10.4?function(e){return i(this,void 0,void 0,(function(){var r,t,o,i;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,s(e+("/"===e[e.length-1]?"":"/")+"retrieveTravelModes",{query:{f:"json"}})];case 1:return r=n.sent().data,t=r.supportedTravelModes,o=r.defaultTravelMode,[2,{supportedTravelModes:t,defaultTravelMode:o}];case 2:throw i=n.sent(),new a("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:i});case 3:return[2]}}))}))}(e):function(e){return i(this,void 0,void 0,(function(){var r,t,o,i,a,p,c,f,d,y,v,m,h,g,T,b;return n(this,(function(n){switch(n.label){case 0:return[4,s(e.substring(0,e.indexOf("/rest/")+6)+"info",{query:{f:"json"}})];case 1:return(r=n.sent().data)&&r.owningSystemUrl?(e=r.owningSystemUrl,[4,s(e+("/"===e[e.length-1]?"":"/")+"sharing/rest/portals/self",{query:{f:"json"}})]):[2,{supportedTravelModes:[],defaultTravelMode:null}];case 2:return t=n.sent().data,(o=u.getDeepValue("helperServices.routingUtilities.url",t))?(i=l.urlToObject(e),a=/\/solveClosestFacility$/.test(i.path)?"Route":/\/solveClosestFacility$/.test(i.path)?"ClosestFacility":"ServiceAreas",[4,s(o+("/"===o[o.length-1]?"":"/")+"GetTravelModes/execute",{query:{f:"json",serviceName:a}})]):[2,{supportedTravelModes:[],defaultTravelMode:null}];case 3:if(p=n.sent(),c=[],f=null,p&&p.data&&p.data.results&&p.data.results.length)for(d=p.data.results,y=0,v=d;y<v.length;y++)if("supportedTravelModes"===(m=v[y]).paramName){if(m.value&&m.value.features)for(h=0,g=m.value.features;h<g.length;h++)(T=g[h].attributes)&&(b=JSON.parse(T.TravelMode),c.push(b))}else"defaultTravelMode"===m.paramName&&(f=m.value);return[2,{supportedTravelModes:c,defaultTravelMode:f}]}}))}))}(e)];case 2:return o=f.sent(),p=o.defaultTravelMode,c=o.supportedTravelModes,r.defaultTravelMode=p,r.supportedTravelModes=c,[2,r]}}))}))},r.prototype._isInputGeometryZAware=function(e,r){for(var t=0;t<r.length;t++){var o=e[r[t]];if(o&&o.length)for(var n=0,i=o;n<i.length;n++){var s=i[n];if(p.isSome(s)&&s.hasZ)return!0}}return!1},r.prototype._dropZValuesOffInputGeometry=function(e,r){for(var t=0;t<r.length;t++){var o=e[r[t]];if(o&&o.length)for(var n=0,i=o;n<i.length;n++)i[n].z=void 0}},t([c.subclass("esri.tasks.mixins.NAServiceDescription")],r)}(c.declared(e))};var d=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return o(r,e),t([c.subclass("esri.tasks.mixins.NAServiceDescription")],r)}(c.declared(r.NAServiceDescriptionMixin(f)));r.NAServiceDescription=d}.apply(null,o))||(e.exports=n)},1170:function(e,r,t){var o,n;o=[t.dj.c(e.i),r,t(1),t(0),t(12),t(2),t(1128)],void 0===(n=function(e,r,t,o,n,i,s){var a=new n.default({0:"informative",1:"process-definition",2:"process-start",3:"process-stop",50:"warning",100:"error",101:"empty",200:"abort"});return function(e){function r(r){var t=e.call(this,r)||this;return t.type=null,t}return t(r,e),o([i.property({type:String,json:{read:a.read,write:a.write}})],r.prototype,"type",void 0),o([i.subclass("esri.tasks.support.NAMessage")],r)}(i.declared(s))}.apply(null,o))||(e.exports=n)},1252:function(e,r,t){var o,n;o=[t.dj.c(e.i),r,t(1),t(0),t(18),t(43),t(13),t(2),t(100)],void 0===(n=function(e,r,t,o,n,i,s,a,p){return function(e){function r(r){var t=e.call(this,r)||this;return t.extent=null,t.features=null,t.geometryType="polyline",t.routeId=null,t.routeName=null,t.totalDriveTime=null,t.totalLength=null,t.totalTime=null,t}return t(r,e),r.prototype.readFeatures=function(e,r){var t=this;(e||[]).forEach((function(e){t._decompressFeatureGeometry(e,r.summary.envelope.spatialReference)}));var o=n.SpatialReference.fromJSON(r.spatialReference);return e.map((function(e){var r=i.fromJSON(e),t=e.geometry&&e.geometry.spatialReference;return r.geometry&&!t&&(s.unwrap(r.geometry).spatialReference=o),r.strings=e.strings,r.events=(e.events||[]).map((function(r){var t=new i({geometry:new n.Point({x:r.point.x,y:r.point.y,z:r.point.z,hasZ:void 0!==r.point.z,spatialReference:e.geometry&&e.geometry.spatialReference}),attributes:{ETA:r.ETA,arriveTimeUTC:r.arriveTimeUTC}});return t.strings=r.strings,t})),r}))},Object.defineProperty(r.prototype,"mergedGeometry",{get:function(){if(!this.features)return null;var e=this.features.map((function(e){var r=e.geometry;return s.unwrap(r)})),r=this.get("extent.spatialReference");return this._mergePolylinesToSinglePath(e,r)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"strings",{get:function(){return this.features.map((function(e){return e.strings}))},enumerable:!0,configurable:!0}),r.prototype._decompressFeatureGeometry=function(e,r){e.geometry=this._decompressGeometry(e.compressedGeometry,r)},r.prototype._decompressGeometry=function(e,r){var t,o,n,i,s,a,p,u,l=0,c=0,f=0,d=0,y=[],v=0,m=0,h=0;if((s=e.match(/((\+|\-)[^\+\-\|]+|\|)/g))||(s=[]),0===parseInt(s[v],32)){v=2;var g=parseInt(s[v],32);v++,a=parseInt(s[v],32),v++,1&g&&(m=s.indexOf("|")+1,p=parseInt(s[m],32),m++),2&g&&(h=s.indexOf("|",m)+1,u=parseInt(s[h],32),h++)}else a=parseInt(s[v],32),v++;for(;v<s.length&&"|"!==s[v];){t=parseInt(s[v],32)+l,v++,l=t,o=parseInt(s[v],32)+c,v++,c=o;var T=[t/a,o/a];m&&(i=parseInt(s[m],32)+f,m++,f=i,T.push(i/p)),h&&(n=parseInt(s[h],32)+d,h++,d=n,T.push(n/u)),y.push(T)}return{paths:[y],hasZ:m>0,hasM:h>0,spatialReference:r}},r.prototype._mergePolylinesToSinglePath=function(e,r){var t=[];(e||[]).forEach((function(e){e.paths.forEach((function(e){t=t.concat(e)}))}));var o=[],i=[0,0];return t.forEach((function(e){e[0]===i[0]&&e[1]===i[1]||(o.push(e),i=e)})),new n.Polyline({paths:[o]},r)},o([a.property({type:n.Extent,json:{read:{source:"summary.envelope"}}})],r.prototype,"extent",void 0),o([a.property()],r.prototype,"features",void 0),o([a.reader("features")],r.prototype,"readFeatures",null),o([a.property()],r.prototype,"geometryType",void 0),o([a.property({readOnly:!0,dependsOn:["features","extent.spatialReference"]})],r.prototype,"mergedGeometry",null),o([a.property()],r.prototype,"routeId",void 0),o([a.property()],r.prototype,"routeName",void 0),o([a.property({value:null,readOnly:!0,dependsOn:["features"]})],r.prototype,"strings",null),o([a.property({json:{read:{source:"summary.totalDriveTime"}}})],r.prototype,"totalDriveTime",void 0),o([a.property({json:{read:{source:"summary.totalLength"}}})],r.prototype,"totalLength",void 0),o([a.property({json:{read:{source:"summary.totalTime"}}})],r.prototype,"totalTime",void 0),o([a.subclass("esri.tasks.support.DirectionsFeatureSet")],r)}(a.declared(p))}.apply(null,o))||(e.exports=n)},1525:function(e,r,t){var o,n;o=[t.dj.c(e.i),r,t(1),t(0),t(18),t(43),t(3),t(13),t(2),t(365),t(24),t(1252),t(100),t(1170)],void 0===(n=function(e,r,t,o,n,i,s,a,p,u,l,c,f,d){function y(e){return f.fromJSON(e).features.map((function(e){return e.geometry}))}return function(e){function r(r){var t=e.call(this,r)||this;return t.directions=null,t.facilities=null,t.incidents=null,t.messages=null,t.pointBarriers=null,t.polylineBarriers=null,t.polygonBarriers=null,t.routes=null,t}return t(r,e),r.prototype.readFacilities=function(e){return y(e)},r.prototype.readIncidents=function(e){return y(e)},r.prototype.readPointBarriers=function(e,r){return y(r.barriers)},r.prototype.readPolylineBarriers=function(e){return y(e)},r.prototype.readPolygonBarriers=function(e){return y(e)},r.prototype.readRoutes=function(e){return function(e){return e.features.map((function(r){var t=l.fromJSON(e.spatialReference),o=i.fromJSON(r);return a.isSome(o.geometry)&&(o.geometry.spatialReference=t),o}))}(e)},o([p.property({type:c})],r.prototype,"directions",void 0),o([p.property({type:[n.Point]})],r.prototype,"facilities",void 0),o([u.reader("facilities")],r.prototype,"readFacilities",null),o([p.property({type:[n.Point]})],r.prototype,"incidents",void 0),o([u.reader("incidents")],r.prototype,"readIncidents",null),o([p.property({type:[d]})],r.prototype,"messages",void 0),o([p.property({type:[n.Point]})],r.prototype,"pointBarriers",void 0),o([u.reader("pointBarriers",["barriers"])],r.prototype,"readPointBarriers",null),o([p.property({type:[n.Polyline]})],r.prototype,"polylineBarriers",void 0),o([u.reader("polylineBarriers")],r.prototype,"readPolylineBarriers",null),o([p.property({type:[n.Polygon]})],r.prototype,"polygonBarriers",void 0),o([u.reader("polygonBarriers")],r.prototype,"readPolygonBarriers",null),o([p.property({type:[i]})],r.prototype,"routes",void 0),o([u.reader("routes")],r.prototype,"readRoutes",null),o([p.subclass("esri.tasks.support.ClosestFacilitySolveResult")],r)}(p.declared(s.JSONSupport))}.apply(null,o))||(e.exports=n)}}]);