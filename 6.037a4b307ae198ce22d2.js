(function(){(this||window).webpackJsonp.registerAbsMids({"esri/layers/support/sublayerUtils":1198,"esri/layers/support/Sublayer":1314,"esri/layers/mixins/ArcGISMapService":1428,"esri/layers/mixins/SublayersOwner":1429})})(),(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{1198:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(218)],void 0===(n=function(e,r,t){function i(e,r){if(!e||!e.length)return!0;var t=r.slice().reverse().flatten((function(e){var r=e.sublayers;return r&&r.toArray().reverse()})).map((function(e){return e.id})).toArray();if(e.length>t.length)return!1;for(var i=0,n=t.length,o=0,a=e;o<a.length;o++){for(var l=a[o].id;i<n&&t[i]!==l;)i++;if(i>=n)return!1}return!0}Object.defineProperty(r,"__esModule",{value:!0}),r.shouldWriteSublayerStructure=function(e,r,t){return r.flatten((function(e){return e.sublayers})).length!==e.length||!!e.some((function(e){return e.originIdOf("minScale")>t||e.originIdOf("maxScale")>t||e.originIdOf("renderer")>t||e.originIdOf("labelingInfo")>t||e.originIdOf("opacity")>t||e.originIdOf("labelsVisible")>t||e.originIdOf("source")>t}))||!i(e,r)},r.isExportDynamic=function(e,r,n){return!!e.some((function(e){var r=e.source;return!(!r||r.type===t.MAPLAYER&&r.mapLayerId===e.id&&(!r.gdbVersion||r.gdbVersion===n.gdbVersion))||e.originIdOf("renderer")>2||e.originIdOf("labelingInfo")>2||e.originIdOf("opacity")>2||e.originIdOf("labelsVisible")>2}))||!i(e,r)},r.isSublayerOverhaul=function(e){return!!e&&e.some((function(e){return null!=e.minScale||e.layerDefinition&&null!=e.layerDefinition.minScale}))}}.apply(null,i))||(e.exports=n)},1314:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(1),t(0),t(61),t(8),t(9),t(5),t(18),t(66),t(349),t(31),t(42),t(20),t(10),t(132),t(7),t(55),t(6),t(323),t(4),t(23),t(2),t(14),t(144),t(41),t(392),t(79),t(328),t(28),t(216),t(218),t(136),t(340),t(101)],void 0===(n=function(e,r,i,n,o,a,l,s,p,u,y,d,c,f,b,h,g,v,m,S,w,I,O,x,L,D,j,P,E,T,_,M,F,N,A){function V(e){return e&&"esriSMS"===e.type}function J(e,r,t){return{ignoreOrigin:!0,enabled:t&&t.writeSublayerStructure||!1}}function C(e,r,t){return{ignoreOrigin:!0,enabled:!!t&&(t.writeSublayerStructure||this.originIdOf(r)>=L.nameToId(t.origin))}}var k=m.getLogger("esri.layers.support.Sublayer"),R=0,B=new Set;return B.add("layer"),B.add("parent"),B.add("loaded"),B.add("loadStatus"),B.add("loadError"),B.add("loadWarnings"),function(e){function r(r){var t=e.call(this,r)||this;return t.capabilities=void 0,t.fields=null,t.fullExtent=null,t.globalIdField=null,t.legendEnabled=!0,t.objectIdField=null,t.popupEnabled=!0,t.popupTemplate=null,t.sourceJSON=null,t.title=null,t.typeIdField=null,t.types=null,t}var o;return i(r,e),o=r,r.prototype.load=function(e){return l(this,void 0,void 0,(function(){var r=this;return a(this,(function(t){return this.addResolvingPromise(l(r,void 0,void 0,(function(){var r,t,i;return a(this,(function(n){switch(n.label){case 0:if(!this.layer)throw new b("sublayer:missing-layer","Sublayer can't be loaded without being part of a layer",{sublayer:this});return r=null,this.originIdOf("url")>2||M.isDataLayerSource(this.source)?[4,d(this.url,s({responseType:"json",query:{f:"json"}},e))]:[3,2];case 1:return t=n.sent(),r=t.data,[3,4];case 2:return i=this.id,this.source&&null!=this.source.mapLayerId&&(i=this.source.mapLayerId),[4,this.layer.fetchSublayerInfo(i,e)];case 3:r=n.sent(),n.label=4;case 4:return r&&(this.sourceJSON=r,this.read({layerDefinition:r},{origin:"service"})),[2]}}))}))),[2,this]}))}))},r.prototype.readCapabilities=function(e,r){return{exportMap:{supportsModification:!!r.layerDefinition.canModifyLayer}}},Object.defineProperty(r.prototype,"definitionExpression",{set:function(e){this._setAndNotifyLayer("definitionExpression",e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"fieldsIndex",{get:function(){return new E(this.fields||[])},enumerable:!0,configurable:!0}),r.prototype.readGlobalIdFieldFromService=function(e,r){if((r=r.layerDefinition||r).globalIdField)return r.globalIdField;if(r.fields)for(var t=0,i=r.fields;t<i.length;t++){var n=i[t];if("esriFieldTypeGlobalID"===n.type)return n.name}},Object.defineProperty(r.prototype,"id",{get:function(){var e=this._get("id");return null==e?R++:e},set:function(e){this._get("id")!==e&&(!1!==this.get("layer.capabilities.exportMap.supportsDynamicLayers")?this._set("id",e):this._logLockedError("id","capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"labelingInfo",{set:function(e){this._setAndNotifyLayer("labelingInfo",e)},enumerable:!0,configurable:!0}),r.prototype.writeLabelingInfo=function(e,r,t,i){e&&e.length&&(r.layerDefinition={drawingInfo:{labelingInfo:e.map((function(e){return e.write({},i)}))}})},Object.defineProperty(r.prototype,"labelsVisible",{set:function(e){this._setAndNotifyLayer("labelsVisible",e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"layer",{set:function(e){this._set("layer",e),this.sublayers&&this.sublayers.forEach((function(r){return r.layer=e}))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"listMode",{set:function(e){this._set("listMode",e)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"minScale",{set:function(e){this._setAndNotifyLayer("minScale",e)},enumerable:!0,configurable:!0}),r.prototype.readMinScale=function(e,r){return r.minScale||r.layerDefinition&&r.layerDefinition.minScale||0},Object.defineProperty(r.prototype,"maxScale",{set:function(e){this._setAndNotifyLayer("maxScale",e)},enumerable:!0,configurable:!0}),r.prototype.readMaxScale=function(e,r){return r.maxScale||r.layerDefinition&&r.layerDefinition.maxScale||0},r.prototype.readObjectIdFieldFromService=function(e,r){if((r=r.layerDefinition||r).objectIdField)return r.objectIdField;if(r.fields)for(var t=0,i=r.fields;t<i.length;t++){var n=i[t];if("esriFieldTypeOID"===n.type)return n.name}},Object.defineProperty(r.prototype,"opacity",{set:function(e){this._setAndNotifyLayer("opacity",e)},enumerable:!0,configurable:!0}),r.prototype.readOpacity=function(e,r){var t=r.layerDefinition;return 1-.01*(null!=t.transparency?t.transparency:t.drawingInfo.transparency)},r.prototype.writeOpacity=function(e,r,t,i){r.layerDefinition={drawingInfo:{transparency:100-100*e}}},r.prototype.writeParent=function(e,r){this.parent&&this.parent!==this.layer?r.parentLayerId=this.parent.id:r.parentLayerId=-1},Object.defineProperty(r.prototype,"defaultPopupTemplate",{get:function(){return this.createPopupTemplate()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"renderer",{set:function(e){if(e)for(var r=0,t=e.getSymbols();r<t.length;r++){var i=t[r];if(c.isSymbol3D(i)){k.warn("Sublayer renderer should use 2D symbols");break}}this._setAndNotifyLayer("renderer",e)},enumerable:!0,configurable:!0}),r.prototype.readRenderer=function(e,r,t){return(e=r.layerDefinition.drawingInfo.renderer||void 0)&&((e=F.read(e,r,t)||void 0)||k.error("Failed to create renderer",{rendererDefinition:r.drawingInfo.renderer,layer:this,context:t})),e},r.prototype.writeRenderer=function(e,r,t,i){r.layerDefinition={drawingInfo:{renderer:e.write({},i)}}},r.prototype.writeWebSceneRenderer=function(e,r,t,i){r.layerDefinition={drawingInfo:{renderer:e.write({},i)}}},Object.defineProperty(r.prototype,"source",{get:function(){return this._get("source")||{mapLayerId:this.id,type:M.MAPLAYER}},set:function(e){this._setAndNotifyLayer("source",e)},enumerable:!0,configurable:!0}),r.prototype.writeSource=function(e,r){r.layerDefinition={source:M.sourceToJSON(e)}},Object.defineProperty(r.prototype,"sublayers",{set:function(e){this._handleSublayersChange(e,this._get("sublayers")),this._set("sublayers",e)},enumerable:!0,configurable:!0}),r.prototype.castSublayers=function(e){return x.default(f.ofType(o),e)},r.prototype.writeSublayers=function(e,r,t){this.get("sublayers.length")&&(r[t]=this.sublayers.map((function(e){return e.id})).toArray().reverse())},r.prototype.readTypeIdField=function(e,r){var t=(r=r.layerDefinition||r).typeIdField;if(t){var i=T.getField(r.fields,t);if(i)return i.name}return null},Object.defineProperty(r.prototype,"url",{get:function(){var e=this.layer,r=this.source;if(!e)return null;if(M.isMapLayerSource(r))return e.parsedUrl.path+"/"+r.mapLayerId;var t={layer:JSON.stringify({source:M.sourceToJSON(this.source)})};return e.parsedUrl.path+"/dynamicLayer?"+I.objectToQuery(t)},set:function(e){e?this._override("url",e):this._clearOverride("url")},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visible",{set:function(e){this._setAndNotifyLayer("visible",e)},enumerable:!0,configurable:!0}),r.prototype.writeVisible=function(e,r,t,i){r[t]=this.getAtOrigin("defaultVisibility","service")||e},r.prototype.clone=function(){var e=D.getProperties(this).store,r=new o;return D.getProperties(r).store=e.clone(B),r},r.prototype.createPopupTemplate=function(e){return N.createPopupTemplate(this,e)},r.prototype.createQuery=function(){return new A({returnGeometry:!0,where:this.definitionExpression||"1=1"})},r.prototype.createFeatureLayer=function(){return l(this,void 0,void 0,(function(){var e,r,i,n,o;return a(this,(function(a){switch(a.label){case 0:return this.hasOwnProperty("sublayers")?[2,null]:(e=this.layer&&this.layer.parsedUrl,r=this.source,i=null,e&&(i=M.isMapLayerSource(r)?e.path+"/"+r.mapLayerId:e.path+"/dynamicLayer"),[4,w.create((function(e){return Promise.resolve().then(function(){var r=[t(199)];e.apply(null,r)}.bind(this)).catch(t.oe)}))]);case 1:return n=a.sent(),o=new n({url:i}),this.definitionExpression&&(o.definitionExpression=this.definitionExpression),this.originIdOf("labelingInfo")>2&&(o.labelingInfo=g.clone(this.labelingInfo)),this.originIdOf("labelsVisible")>0&&(o.labelsVisible=this.labelsVisible),this.originIdOf("legendEnabled")>0&&(o.legendEnabled=this.legendEnabled),this.originIdOf("visible")>0&&(o.visible=this.visible),this.originIdOf("minScale")>0&&(o.minScale=this.minScale),this.originIdOf("maxScale")>0&&(o.maxScale=this.maxScale),this.originIdOf("opacity")>0&&(o.opacity=this.opacity),this.originIdOf("popupTemplate")>0&&(o.popupTemplate=g.clone(this.popupTemplate)),this.originIdOf("renderer")>2&&(o.renderer=g.clone(this.renderer)),M.isDataLayerSource(this.source)&&(o.dynamicDataSource=g.clone(this.source)),this.originIdOf("title")>0&&(o.title=this.title),[2,o]}}))}))},r.prototype.getFeatureType=function(e){var r=this.typeIdField,t=this.types;if(!r||!e)return null;var i=e.attributes?e.attributes[r]:void 0;if(null==i)return null;var n=null;return t.some((function(e){var r=e.id;return null!=r&&(r.toString()===i.toString()&&(n=e),!!n)})),n},r.prototype.getFieldDomain=function(e,r){var t=r&&r.feature,i=this.getFeatureType(t);if(i){var n=i.domains&&i.domains[e];if(n&&"inherited"!==n.type)return n}return this._getLayerDomain(e)},r.prototype.queryFeatures=function(e,r){var i=this;return void 0===e&&(e=this.createQuery()),w.all([w.create((function(e){return Promise.resolve().then(function(){var r=[t(355)];e.apply(null,r)}.bind(this)).catch(t.oe)})),w.create((function(e){return Promise.resolve().then(function(){var r=[t(100)];e.apply(null,r)}.bind(this)).catch(t.oe)}))]).then((function(t){var n=t[0].executeQuery,o=t[1];return n(i.url,A.from(e),i.layer.spatialReference,r).then((function(e){return o.fromJSON(e.data)}))})).then((function(e){return e&&e.features&&e.features.forEach((function(e){e.sourceLayer=i})),e}))},r.prototype.toExportImageJSON=function(){var e=this,r={id:this.id,source:M.sourceToJSON(this.source)};this.definitionExpression&&(r.definitionExpression=this.definitionExpression);var t=["renderer","labelingInfo","opacity","labelsVisible"].reduce((function(r,t){return r[t]=e.originIdOf(t),r}),{});if(Object.keys(t).some((function(e){return t[e]>=2}))){var i=r.drawingInfo={};t.renderer>=2&&(i.renderer=this.renderer?this.renderer.toJSON():null),t.labelsVisible>=2&&(i.showLabels=this.labelsVisible),this.labelsVisible&&t.labelingInfo>=2&&(i.labelingInfo=this.labelingInfo?this.labelingInfo.map((function(e){return e.write({},{origin:"service"})})):null,i.showLabels=!0),t.opacity>=2&&(i.transparency=100-100*this.opacity),this._assignDefaultSymbolColors(i.renderer)}return r},r.prototype._assignDefaultSymbolColors=function(e){this._forEachSimpleMarkerSymbols(e,(function(e){e.color||"esriSMSX"!==e.style&&"esriSMSCross"!==e.style||(e.outline&&e.outline.color?e.color=e.outline.color:e.color=[0,0,0,0])}))},r.prototype._forEachSimpleMarkerSymbols=function(e,r){if(e){for(var t=0,i=("uniqueValueInfos"in e?e.uniqueValueInfos:"classBreakInfos"in e?e.classBreakInfos:[]);t<i.length;t++){var n=i[t];V(n.symbol)&&r(n.symbol)}"symbol"in e&&V(e.symbol)&&r(e.symbol),"defaultSymbol"in e&&V(e.defaultSymbol)&&r(e.defaultSymbol)}},r.prototype._setAndNotifyLayer=function(e,r){var t,i,n=this.layer,o=this._get(e);switch(e){case"definitionExpression":t="supportsSublayerDefinitionExpression";case"minScale":case"maxScale":case"visible":t="supportsSublayerVisibility";break;case"labelingInfo":case"labelsVisible":case"opacity":case"renderer":case"source":t="supportsDynamicLayers",i="supportsModification"}var a=D.getProperties(this).getDefaultOrigin();if("service"!==a){if(t&&!1===this.get("layer.capabilities.exportMap."+t))return void this._logLockedError(e,"capability not available 'layer.capabilities.exportMap."+t+"'");if(i&&!1===this.get("capabilities.exportMap."+i))return void this._logLockedError(e,"capability not available 'capabilities.exportMap."+i+"'")}"source"!==e||"not-loaded"===this.loadStatus?(this._set(e,r),"service"!==a&&o!==r&&n&&n.emit&&n.emit("sublayer-update",{propertyName:e})):this._logLockedError(e,"'source' can't be changed after calling sublayer.load()")},r.prototype._handleSublayersChange=function(e,r){var t=this;r&&(r.forEach((function(e){e.parent=null,e.layer=null})),this.handles.removeAll()),e&&(e.forEach((function(e){e.parent=t,e.layer=t.layer})),this.handles.add([e.on("after-add",(function(e){var r=e.item;r.parent=t,r.layer=t.layer})),e.on("after-remove",(function(e){var r=e.item;r.parent=null,r.layer=null})),e.on("before-changes",(function(e){var r=t.get("layer.capabilities.exportMap.supportsSublayersChanges");null==r||r||(k.error(new b("sublayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{sublayer:t,layer:t.layer})),e.preventDefault())}))]))},r.prototype._logLockedError=function(e,r){k.error(new b("sublayer:locked","Property '"+e+"' can't be changed on Sublayer from the layer '"+this.layer.id+"'",{reason:r,sublayer:this,layer:this.layer}))},r.prototype._getLayerDomain=function(e){var r=this.fieldsIndex.get(e);return r?r.domain:null},n([O.property({readOnly:!0})],r.prototype,"capabilities",void 0),n([O.reader("service","capabilities",["layerDefinition.canModifyLayer"])],r.prototype,"readCapabilities",null),n([O.property({type:String,value:null,json:{read:{source:"layerDefinition.definitionExpression"},write:{target:"layerDefinition.definitionExpression",overridePolicy:C}}})],r.prototype,"definitionExpression",null),n([O.property({type:[P],json:{origins:{service:{read:{source:"layerDefinition.fields"}}}}})],r.prototype,"fields",void 0),n([O.property({readOnly:!0,dependsOn:["fields"]})],r.prototype,"fieldsIndex",null),n([O.property({type:p.Extent,json:{read:{source:"layerDefinition.extent"}}})],r.prototype,"fullExtent",void 0),n([O.property({type:String})],r.prototype,"globalIdField",void 0),n([O.reader("service","globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],r.prototype,"readGlobalIdFieldFromService",null),n([O.property({type:Number,json:{write:{ignoreOrigin:!0}}})],r.prototype,"id",null),n([O.property({value:null,type:[_],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo",overridePolicy:J}}})],r.prototype,"labelingInfo",null),n([O.writer("labelingInfo")],r.prototype,"writeLabelingInfo",null),n([O.property({type:Boolean,value:!0,json:{read:{source:"layerDefinition.drawingInfo.showLabels"},write:{target:"layerDefinition.drawingInfo.showLabels",overridePolicy:J}}})],r.prototype,"labelsVisible",null),n([O.property({value:null})],r.prototype,"layer",null),n([O.property({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend",overridePolicy:C}}})],r.prototype,"legendEnabled",void 0),n([O.property({type:["show","hide","hide-children"],value:"show",json:{read:!1,write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],r.prototype,"listMode",null),n([O.property({type:Number,value:0,json:{write:{enabled:!1,overridePolicy:J}}})],r.prototype,"minScale",null),n([O.reader("minScale",["minScale","layerDefinition.minScale"])],r.prototype,"readMinScale",null),n([O.property({type:Number,value:0,json:{write:{enabled:!1,overridePolicy:J}}})],r.prototype,"maxScale",null),n([O.reader("maxScale",["maxScale","layerDefinition.maxScale"])],r.prototype,"readMaxScale",null),n([O.property({type:String})],r.prototype,"objectIdField",void 0),n([O.reader("service","objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],r.prototype,"readObjectIdFieldFromService",null),n([O.property({type:Number,value:1,json:{write:{target:"layerDefinition.drawingInfo.transparency",overridePolicy:J}}})],r.prototype,"opacity",null),n([O.reader("opacity",["layerDefinition.drawingInfo.transparency","layerDefinition.transparency"])],r.prototype,"readOpacity",null),n([O.writer("opacity")],r.prototype,"writeOpacity",null),n([O.property({json:{type:Number,write:{target:"parentLayerId",allowNull:!0,overridePolicy:J}}})],r.prototype,"parent",void 0),n([O.writer("parent")],r.prototype,"writeParent",null),n([O.property({type:Boolean,value:!0,json:{read:{source:"disablePopup",reader:function(e,r){return!r.disablePopup}},write:{target:"disablePopup",overridePolicy:C,writer:function(e,r,t){r[t]=!e}}}})],r.prototype,"popupEnabled",void 0),n([O.property({type:u,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:C}}})],r.prototype,"popupTemplate",void 0),n([O.property({readOnly:!0,dependsOn:["fields","title"]})],r.prototype,"defaultPopupTemplate",null),n([O.property({types:y.rendererTypes,value:null,json:{write:{target:"layerDefinition.drawingInfo.renderer",overridePolicy:J}}})],r.prototype,"renderer",null),n([O.reader("renderer",["layerDefinition.drawingInfo.renderer"])],r.prototype,"readRenderer",null),n([O.writer("renderer")],r.prototype,"writeRenderer",null),n([O.writer("web-scene","renderer",{"layerDefinition.drawingInfo.renderer":{types:y.webSceneRendererTypes}})],r.prototype,"writeWebSceneRenderer",null),n([O.property({cast:M.castSource,json:{read:{source:"layerDefinition.source",reader:M.sourceFromJSON},write:{target:"layerDefinition.source",overridePolicy:J}}})],r.prototype,"source",null),n([O.writer("source")],r.prototype,"writeSource",null),n([O.property()],r.prototype,"sourceJSON",void 0),n([O.property({value:null,json:{type:[x.Integer],write:{target:"subLayerIds",allowNull:!0,overridePolicy:J}}})],r.prototype,"sublayers",null),n([O.cast("sublayers")],r.prototype,"castSublayers",null),n([O.writer("sublayers")],r.prototype,"writeSublayers",null),n([O.property({type:String,json:{read:{source:"name"},write:{target:"name",allowNull:!0,overridePolicy:C}}})],r.prototype,"title",void 0),n([O.property({type:String})],r.prototype,"typeIdField",void 0),n([O.reader("typeIdField",["layerDefinition.typeIdField"])],r.prototype,"readTypeIdField",null),n([O.property({type:[j],json:{origins:{service:{read:{source:"layerDefinition.types"}}}}})],r.prototype,"types",void 0),n([O.property({type:String,dependsOn:["layer","source"],json:{read:{source:"layerUrl"},write:{target:"layerUrl",overridePolicy:function(){return{enabled:this._isOverridden("url")}}}}})],r.prototype,"url",null),n([O.property({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility",overridePolicy:J}}})],r.prototype,"visible",null),n([O.writer("visible")],r.prototype,"writeVisible",null),o=n([O.subclass("esri.layers.support.Sublayer")],r)}(O.declared(h.HandleOwnerMixin(S.MultiOriginJSONMixin(v))))}.apply(null,i))||(e.exports=n)},1428:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(1),t(0),t(8),t(9),t(5),t(31),t(4),t(23),t(2),t(36),t(24),t(197)],void 0===(n=function(e,r,t,i,n,o,a,l,s,p,u,y,d,c){Object.defineProperty(r,"__esModule",{value:!0}),r.ArcGISMapService=function(e){return function(e){function r(){var r=null!==e&&e.apply(this,arguments)||this;return r.capabilities=void 0,r.copyright=null,r.fullExtent=null,r.legendEnabled=!0,r.spatialReference=null,r.version=null,r}return t(r,e),r.prototype.readCapabilities=function(e,r){var t=r.capabilities&&r.capabilities.split(",").map((function(e){return e.toLowerCase().trim()}));if(!t)return{operations:{supportsQuery:!1,supportsExportMap:!1,supportsExportTiles:!1,supportsTileMap:!1},exportMap:null,exportTiles:null};var i=this.type,n=-1!==t.indexOf("query"),o=-1!==t.indexOf("map"),a=!!r.exportTilesAllowed,l=-1!==t.indexOf("tilemap"),s="tile"!==i&&!!r.supportsDynamicLayers,p="tile"!==i&&(!r.tileInfo||s),u="tile"!==i&&(!r.tileInfo||s);return{operations:{supportsQuery:n,supportsExportMap:o,supportsExportTiles:a,supportsTileMap:l},exportMap:o?{supportsSublayersChanges:"tile"!==i,supportsDynamicLayers:s,supportsSublayerVisibility:p,supportsSublayerDefinitionExpression:u}:null,exportTiles:a?{maxExportTilesCount:+r.maxExportTilesCount}:null}},r.prototype.readVersion=function(e,r){var t=r.currentVersion;return t||(t=r.hasOwnProperty("capabilities")||r.hasOwnProperty("tables")?10:r.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3),t},r.prototype.fetchSublayerInfo=function(e,r){return o(this,void 0,void 0,(function(){return n(this,(function(t){switch(t.label){case 0:return[4,this.fetchAllLayersAndTables(r)];case 1:return t.sent(),[2,this._allLayersAndTablesMap.get(e)]}}))}))},r.prototype.fetchAllLayersAndTables=function(e){return o(this,void 0,void 0,(function(){var r,t=this;return n(this,(function(i){switch(i.label){case 0:return[4,this.load(e)];case 1:return i.sent(),this._allLayersAndTablesPromise||(this._allLayersAndTablesPromise=l(p.urlToObject(this.url).path+"/layers",{responseType:"json",query:{f:"json"}}).then((function(e){t._allLayersAndTablesMap=new Map;for(var r=0,i=e.data.layers;r<i.length;r++){var n=i[r];t._allLayersAndTablesMap.set(n.id,n)}return{result:e.data}}),(function(e){return{error:e}}))),[4,this._allLayersAndTablesPromise];case 2:if(r=i.sent(),s.throwIfAborted(e),"result"in r)return[2,r.result];throw r.error}}))}))},i([u.property({readOnly:!0})],r.prototype,"capabilities",void 0),i([u.reader("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount","supportsDynamicLayers","tileInfo"])],r.prototype,"readCapabilities",null),i([u.property({json:{read:{source:"copyrightText"}}})],r.prototype,"copyright",void 0),i([u.property({type:y})],r.prototype,"fullExtent",void 0),i([u.property({json:{origins:{service:{read:!1},"portal-item":{read:!1}}}})],r.prototype,"id",void 0),i([u.property({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],r.prototype,"legendEnabled",void 0),i([u.property(c.popupEnabled)],r.prototype,"popupEnabled",void 0),i([u.property({type:d})],r.prototype,"spatialReference",void 0),i([u.property()],r.prototype,"version",void 0),i([u.reader("version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],r.prototype,"readVersion",null),i([u.subclass("esri.layers.mixins.ArcGISMapService")],r)}(u.declared(e))}}.apply(null,i))||(e.exports=n)},1429:function(e,r,t){var i,n;i=[t.dj.c(e.i),r,t(5),t(1),t(0),t(20),t(213),t(10),t(6),t(2),t(144),t(41),t(1314),t(1198)],void 0===(n=function(e,r,t,i,n,o,a,l,s,p,u,y,d,c){Object.defineProperty(r,"__esModule",{value:!0});var f=s.getLogger("esri.layers.TileLayer"),b=o.ofType(d);function h(e,r){e&&e.forEach((function(e){r(e),e.sublayers&&e.sublayers.length&&h(e.sublayers,r)}))}r.forEachSublayer=h,r.SublayersOwner=function(e){return function(e){function r(){for(var r,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=e.apply(this,t)||this;return n.allSublayers=new a({root:n,rootCollectionNames:["sublayers"],getChildrenFunction:function(e){return e.sublayers}}),n.sublayersSourceJSON=((r={})[2]={},r[3]={},r[4]={},r[5]={},r),n.watch("sublayers",(function(e,r){return n._handleSublayersChange(e,r)}),!0),n}return i(r,e),r.prototype.readSublayers=function(e,r){if(r&&e){var t=this.sublayersSourceJSON,i=u.nameToId(r.origin);if(!(i<2||(t[i]={context:r,visibleLayers:e.visibleLayers||t[i].visibleLayers,layers:e.layers||t[i].layers},i>2))){this._set("serviceSublayers",this.createSublayersForOrigin("service").sublayers);var n=this.createSublayersForOrigin("web-document"),o=n.sublayers,a=n.origin,l=y.getProperties(this);l.setDefaultOrigin(a),this._set("sublayers",new b(o)),l.setDefaultOrigin("user")}}},r.prototype.findSublayerById=function(e){return this.allSublayers.find((function(r){return r.id===e}))},r.prototype.createServiceSublayers=function(){return this.createSublayersForOrigin("service").sublayers},r.prototype.createSublayersForOrigin=function(e){for(var r="web-document"===e?u.nameToId("web-map"):u.nameToId(e),t=2,i=this.sublayersSourceJSON[2].layers,n=this.sublayersSourceJSON[2].context,o=null,a=0,l=[3,4,5].filter((function(e){return e<=r}));a<l.length;a++){var s=l[a],p=this.sublayersSourceJSON[s];c.isSublayerOverhaul(p.layers)&&(t=s,i=p.layers,n=p.context,p.visibleLayers&&(o={visibleLayers:p.visibleLayers,context:p.context}))}for(var y=[3,4,5].filter((function(e){return e>t&&e<=r})),f=null,g=0,v=y;g<v.length;g++){var m=v[g],S=this.sublayersSourceJSON[m],w=S.layers,I=S.visibleLayers,O=S.context;w&&(f={layers:w,context:O}),I&&(o={visibleLayers:I,context:O})}var x=function(e,r){var t=[],i={};return e?(e.forEach((function(e){var n=new d;if(n.read(e,r),i[n.id]=n,null!=e.parentLayerId&&-1!==e.parentLayerId){var o=i[e.parentLayerId];o.sublayers||(o.sublayers=[]),o.sublayers.unshift(n)}else t.unshift(n)})),t):t}(i,n),L=new Map,D=new Set;if(f)for(var j=0,P=f.layers;j<P.length;j++){var E=P[j];L.set(E.id,E)}if(o)for(var T=0,_=o.visibleLayers;T<_.length;T++){var M=_[T];D.add(M)}return h(x,(function(e){f&&e.read(L.get(e.id),f.context),o&&e.read({defaultVisibility:D.has(e.id)},o.context)})),{origin:u.idToName(t),sublayers:new b({items:x})}},r.prototype.read=function(e,r){this.inherited(arguments),this.readSublayers(e,r)},r.prototype._handleSublayersChange=function(e,r){var t=this;r&&(r.forEach((function(e){e.parent=null,e.layer=null})),this.handles.remove("sublayers-owner")),e&&(e.forEach((function(e){e.parent=t,e.layer=t})),this.handles.add([e.on("after-add",(function(e){var r=e.item;r.parent=t,r.layer=t})),e.on("after-remove",(function(e){var r=e.item;r.parent=null,r.layer=null}))],"sublayers-owner"),"tile"===this.type&&this.handles.add(e.on("before-changes",(function(e){f.error(new l("tilelayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{layer:t})),e.preventDefault()})),"sublayers-owner"))},n([p.property({readOnly:!0})],r.prototype,"allSublayers",void 0),n([p.property({readOnly:!0,type:o.ofType(d)})],r.prototype,"serviceSublayers",void 0),n([p.property({value:null,type:b,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],r.prototype,"sublayers",void 0),n([p.property({readOnly:!0})],r.prototype,"sublayersSourceJSON",void 0),n([p.subclass("esri.layers.mixins.SublayersOwner")],r)}(p.declared(e))}}.apply(null,i))||(e.exports=n)}}]);